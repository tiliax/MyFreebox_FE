{"ast":null,"code":"import { Util, Evented } from 'leaflet';\nimport { cors } from '../Support';\nimport { cleanUrl, getUrlParams } from '../Util';\nimport Request from '../Request';\nexport var Service = Evented.extend({\n  options: {\n    proxy: false,\n    useCors: cors,\n    timeout: 0\n  },\n  initialize: function (options) {\n    options = options || {};\n    this._requestQueue = [];\n    this._authenticating = false;\n    Util.setOptions(this, options);\n    this.options.url = cleanUrl(this.options.url);\n  },\n  get: function (path, params, callback, context) {\n    return this._request('get', path, params, callback, context);\n  },\n  post: function (path, params, callback, context) {\n    return this._request('post', path, params, callback, context);\n  },\n  request: function (path, params, callback, context) {\n    return this._request('request', path, params, callback, context);\n  },\n  metadata: function (callback, context) {\n    return this._request('get', '', {}, callback, context);\n  },\n  authenticate: function (token) {\n    this._authenticating = false;\n    this.options.token = token;\n\n    this._runQueue();\n\n    return this;\n  },\n  getTimeout: function () {\n    return this.options.timeout;\n  },\n  setTimeout: function (timeout) {\n    this.options.timeout = timeout;\n  },\n  _request: function (method, path, params, callback, context) {\n    this.fire('requeststart', {\n      url: this.options.url + path,\n      params: params,\n      method: method\n    }, true);\n\n    var wrappedCallback = this._createServiceCallback(method, path, params, callback, context);\n\n    if (this.options.token) {\n      params.token = this.options.token;\n    }\n\n    if (this.options.requestParams) {\n      Util.extend(params, this.options.requestParams);\n    }\n\n    if (this._authenticating) {\n      this._requestQueue.push([method, path, params, callback, context]);\n    } else {\n      var url = this.options.proxy ? this.options.proxy + '?' + this.options.url + path : this.options.url + path;\n\n      if ((method === 'get' || method === 'request') && !this.options.useCors) {\n        return Request.get.JSONP(url, params, wrappedCallback, context);\n      } else {\n        return Request[method](url, params, wrappedCallback, context);\n      }\n    }\n  },\n  _createServiceCallback: function (method, path, params, callback, context) {\n    return Util.bind(function (error, response) {\n      if (error && (error.code === 499 || error.code === 498)) {\n        this._authenticating = true;\n\n        this._requestQueue.push([method, path, params, callback, context]); // fire an event for users to handle and re-authenticate\n\n\n        this.fire('authenticationrequired', {\n          authenticate: Util.bind(this.authenticate, this)\n        }, true); // if the user has access to a callback they can handle the auth error\n\n        error.authenticate = Util.bind(this.authenticate, this);\n      }\n\n      callback.call(context, error, response);\n\n      if (error) {\n        this.fire('requesterror', {\n          url: this.options.url + path,\n          params: params,\n          message: error.message,\n          code: error.code,\n          method: method\n        }, true);\n      } else {\n        this.fire('requestsuccess', {\n          url: this.options.url + path,\n          params: params,\n          response: response,\n          method: method\n        }, true);\n      }\n\n      this.fire('requestend', {\n        url: this.options.url + path,\n        params: params,\n        method: method\n      }, true);\n    }, this);\n  },\n  _runQueue: function () {\n    for (var i = this._requestQueue.length - 1; i >= 0; i--) {\n      var request = this._requestQueue[i];\n      var method = request.shift();\n      this[method].apply(this, request);\n    }\n\n    this._requestQueue = [];\n  }\n});\nexport function service(options) {\n  options = getUrlParams(options);\n  return new Service(options);\n}\nexport default service;","map":{"version":3,"names":["Util","Evented","cors","cleanUrl","getUrlParams","Request","Service","extend","options","proxy","useCors","timeout","initialize","_requestQueue","_authenticating","setOptions","url","get","path","params","callback","context","_request","post","request","metadata","authenticate","token","_runQueue","getTimeout","setTimeout","method","fire","wrappedCallback","_createServiceCallback","requestParams","push","JSONP","bind","error","response","code","call","message","i","length","shift","apply","service"],"sources":["C:/Users/Larix/Documents/Programmieren/ABSCHLUSS/wbs-final-box-fe/node_modules/esri-leaflet/src/Services/Service.js"],"sourcesContent":["import { Util, Evented } from 'leaflet';\r\nimport { cors } from '../Support';\r\nimport { cleanUrl, getUrlParams } from '../Util';\r\nimport Request from '../Request';\r\n\r\nexport var Service = Evented.extend({\r\n\r\n  options: {\r\n    proxy: false,\r\n    useCors: cors,\r\n    timeout: 0\r\n  },\r\n\r\n  initialize: function (options) {\r\n    options = options || {};\r\n    this._requestQueue = [];\r\n    this._authenticating = false;\r\n    Util.setOptions(this, options);\r\n    this.options.url = cleanUrl(this.options.url);\r\n  },\r\n\r\n  get: function (path, params, callback, context) {\r\n    return this._request('get', path, params, callback, context);\r\n  },\r\n\r\n  post: function (path, params, callback, context) {\r\n    return this._request('post', path, params, callback, context);\r\n  },\r\n\r\n  request: function (path, params, callback, context) {\r\n    return this._request('request', path, params, callback, context);\r\n  },\r\n\r\n  metadata: function (callback, context) {\r\n    return this._request('get', '', {}, callback, context);\r\n  },\r\n\r\n  authenticate: function (token) {\r\n    this._authenticating = false;\r\n    this.options.token = token;\r\n    this._runQueue();\r\n    return this;\r\n  },\r\n\r\n  getTimeout: function () {\r\n    return this.options.timeout;\r\n  },\r\n\r\n  setTimeout: function (timeout) {\r\n    this.options.timeout = timeout;\r\n  },\r\n\r\n  _request: function (method, path, params, callback, context) {\r\n    this.fire('requeststart', {\r\n      url: this.options.url + path,\r\n      params: params,\r\n      method: method\r\n    }, true);\r\n\r\n    var wrappedCallback = this._createServiceCallback(method, path, params, callback, context);\r\n\r\n    if (this.options.token) {\r\n      params.token = this.options.token;\r\n    }\r\n    if (this.options.requestParams) {\r\n      Util.extend(params, this.options.requestParams);\r\n    }\r\n    if (this._authenticating) {\r\n      this._requestQueue.push([method, path, params, callback, context]);\r\n    } else {\r\n      var url = (this.options.proxy) ? this.options.proxy + '?' + this.options.url + path : this.options.url + path;\r\n\r\n      if ((method === 'get' || method === 'request') && !this.options.useCors) {\r\n        return Request.get.JSONP(url, params, wrappedCallback, context);\r\n      } else {\r\n        return Request[method](url, params, wrappedCallback, context);\r\n      }\r\n    }\r\n  },\r\n\r\n  _createServiceCallback: function (method, path, params, callback, context) {\r\n    return Util.bind(function (error, response) {\r\n      if (error && (error.code === 499 || error.code === 498)) {\r\n        this._authenticating = true;\r\n\r\n        this._requestQueue.push([method, path, params, callback, context]);\r\n\r\n        // fire an event for users to handle and re-authenticate\r\n        this.fire('authenticationrequired', {\r\n          authenticate: Util.bind(this.authenticate, this)\r\n        }, true);\r\n\r\n        // if the user has access to a callback they can handle the auth error\r\n        error.authenticate = Util.bind(this.authenticate, this);\r\n      }\r\n\r\n      callback.call(context, error, response);\r\n\r\n      if (error) {\r\n        this.fire('requesterror', {\r\n          url: this.options.url + path,\r\n          params: params,\r\n          message: error.message,\r\n          code: error.code,\r\n          method: method\r\n        }, true);\r\n      } else {\r\n        this.fire('requestsuccess', {\r\n          url: this.options.url + path,\r\n          params: params,\r\n          response: response,\r\n          method: method\r\n        }, true);\r\n      }\r\n\r\n      this.fire('requestend', {\r\n        url: this.options.url + path,\r\n        params: params,\r\n        method: method\r\n      }, true);\r\n    }, this);\r\n  },\r\n\r\n  _runQueue: function () {\r\n    for (var i = this._requestQueue.length - 1; i >= 0; i--) {\r\n      var request = this._requestQueue[i];\r\n      var method = request.shift();\r\n      this[method].apply(this, request);\r\n    }\r\n    this._requestQueue = [];\r\n  }\r\n});\r\n\r\nexport function service (options) {\r\n  options = getUrlParams(options);\r\n  return new Service(options);\r\n}\r\n\r\nexport default service;\r\n"],"mappings":"AAAA,SAASA,IAAT,EAAeC,OAAf,QAA8B,SAA9B;AACA,SAASC,IAAT,QAAqB,YAArB;AACA,SAASC,QAAT,EAAmBC,YAAnB,QAAuC,SAAvC;AACA,OAAOC,OAAP,MAAoB,YAApB;AAEA,OAAO,IAAIC,OAAO,GAAGL,OAAO,CAACM,MAAR,CAAe;EAElCC,OAAO,EAAE;IACPC,KAAK,EAAE,KADA;IAEPC,OAAO,EAAER,IAFF;IAGPS,OAAO,EAAE;EAHF,CAFyB;EAQlCC,UAAU,EAAE,UAAUJ,OAAV,EAAmB;IAC7BA,OAAO,GAAGA,OAAO,IAAI,EAArB;IACA,KAAKK,aAAL,GAAqB,EAArB;IACA,KAAKC,eAAL,GAAuB,KAAvB;IACAd,IAAI,CAACe,UAAL,CAAgB,IAAhB,EAAsBP,OAAtB;IACA,KAAKA,OAAL,CAAaQ,GAAb,GAAmBb,QAAQ,CAAC,KAAKK,OAAL,CAAaQ,GAAd,CAA3B;EACD,CAdiC;EAgBlCC,GAAG,EAAE,UAAUC,IAAV,EAAgBC,MAAhB,EAAwBC,QAAxB,EAAkCC,OAAlC,EAA2C;IAC9C,OAAO,KAAKC,QAAL,CAAc,KAAd,EAAqBJ,IAArB,EAA2BC,MAA3B,EAAmCC,QAAnC,EAA6CC,OAA7C,CAAP;EACD,CAlBiC;EAoBlCE,IAAI,EAAE,UAAUL,IAAV,EAAgBC,MAAhB,EAAwBC,QAAxB,EAAkCC,OAAlC,EAA2C;IAC/C,OAAO,KAAKC,QAAL,CAAc,MAAd,EAAsBJ,IAAtB,EAA4BC,MAA5B,EAAoCC,QAApC,EAA8CC,OAA9C,CAAP;EACD,CAtBiC;EAwBlCG,OAAO,EAAE,UAAUN,IAAV,EAAgBC,MAAhB,EAAwBC,QAAxB,EAAkCC,OAAlC,EAA2C;IAClD,OAAO,KAAKC,QAAL,CAAc,SAAd,EAAyBJ,IAAzB,EAA+BC,MAA/B,EAAuCC,QAAvC,EAAiDC,OAAjD,CAAP;EACD,CA1BiC;EA4BlCI,QAAQ,EAAE,UAAUL,QAAV,EAAoBC,OAApB,EAA6B;IACrC,OAAO,KAAKC,QAAL,CAAc,KAAd,EAAqB,EAArB,EAAyB,EAAzB,EAA6BF,QAA7B,EAAuCC,OAAvC,CAAP;EACD,CA9BiC;EAgClCK,YAAY,EAAE,UAAUC,KAAV,EAAiB;IAC7B,KAAKb,eAAL,GAAuB,KAAvB;IACA,KAAKN,OAAL,CAAamB,KAAb,GAAqBA,KAArB;;IACA,KAAKC,SAAL;;IACA,OAAO,IAAP;EACD,CArCiC;EAuClCC,UAAU,EAAE,YAAY;IACtB,OAAO,KAAKrB,OAAL,CAAaG,OAApB;EACD,CAzCiC;EA2ClCmB,UAAU,EAAE,UAAUnB,OAAV,EAAmB;IAC7B,KAAKH,OAAL,CAAaG,OAAb,GAAuBA,OAAvB;EACD,CA7CiC;EA+ClCW,QAAQ,EAAE,UAAUS,MAAV,EAAkBb,IAAlB,EAAwBC,MAAxB,EAAgCC,QAAhC,EAA0CC,OAA1C,EAAmD;IAC3D,KAAKW,IAAL,CAAU,cAAV,EAA0B;MACxBhB,GAAG,EAAE,KAAKR,OAAL,CAAaQ,GAAb,GAAmBE,IADA;MAExBC,MAAM,EAAEA,MAFgB;MAGxBY,MAAM,EAAEA;IAHgB,CAA1B,EAIG,IAJH;;IAMA,IAAIE,eAAe,GAAG,KAAKC,sBAAL,CAA4BH,MAA5B,EAAoCb,IAApC,EAA0CC,MAA1C,EAAkDC,QAAlD,EAA4DC,OAA5D,CAAtB;;IAEA,IAAI,KAAKb,OAAL,CAAamB,KAAjB,EAAwB;MACtBR,MAAM,CAACQ,KAAP,GAAe,KAAKnB,OAAL,CAAamB,KAA5B;IACD;;IACD,IAAI,KAAKnB,OAAL,CAAa2B,aAAjB,EAAgC;MAC9BnC,IAAI,CAACO,MAAL,CAAYY,MAAZ,EAAoB,KAAKX,OAAL,CAAa2B,aAAjC;IACD;;IACD,IAAI,KAAKrB,eAAT,EAA0B;MACxB,KAAKD,aAAL,CAAmBuB,IAAnB,CAAwB,CAACL,MAAD,EAASb,IAAT,EAAeC,MAAf,EAAuBC,QAAvB,EAAiCC,OAAjC,CAAxB;IACD,CAFD,MAEO;MACL,IAAIL,GAAG,GAAI,KAAKR,OAAL,CAAaC,KAAd,GAAuB,KAAKD,OAAL,CAAaC,KAAb,GAAqB,GAArB,GAA2B,KAAKD,OAAL,CAAaQ,GAAxC,GAA8CE,IAArE,GAA4E,KAAKV,OAAL,CAAaQ,GAAb,GAAmBE,IAAzG;;MAEA,IAAI,CAACa,MAAM,KAAK,KAAX,IAAoBA,MAAM,KAAK,SAAhC,KAA8C,CAAC,KAAKvB,OAAL,CAAaE,OAAhE,EAAyE;QACvE,OAAOL,OAAO,CAACY,GAAR,CAAYoB,KAAZ,CAAkBrB,GAAlB,EAAuBG,MAAvB,EAA+Bc,eAA/B,EAAgDZ,OAAhD,CAAP;MACD,CAFD,MAEO;QACL,OAAOhB,OAAO,CAAC0B,MAAD,CAAP,CAAgBf,GAAhB,EAAqBG,MAArB,EAA6Bc,eAA7B,EAA8CZ,OAA9C,CAAP;MACD;IACF;EACF,CAzEiC;EA2ElCa,sBAAsB,EAAE,UAAUH,MAAV,EAAkBb,IAAlB,EAAwBC,MAAxB,EAAgCC,QAAhC,EAA0CC,OAA1C,EAAmD;IACzE,OAAOrB,IAAI,CAACsC,IAAL,CAAU,UAAUC,KAAV,EAAiBC,QAAjB,EAA2B;MAC1C,IAAID,KAAK,KAAKA,KAAK,CAACE,IAAN,KAAe,GAAf,IAAsBF,KAAK,CAACE,IAAN,KAAe,GAA1C,CAAT,EAAyD;QACvD,KAAK3B,eAAL,GAAuB,IAAvB;;QAEA,KAAKD,aAAL,CAAmBuB,IAAnB,CAAwB,CAACL,MAAD,EAASb,IAAT,EAAeC,MAAf,EAAuBC,QAAvB,EAAiCC,OAAjC,CAAxB,EAHuD,CAKvD;;;QACA,KAAKW,IAAL,CAAU,wBAAV,EAAoC;UAClCN,YAAY,EAAE1B,IAAI,CAACsC,IAAL,CAAU,KAAKZ,YAAf,EAA6B,IAA7B;QADoB,CAApC,EAEG,IAFH,EANuD,CAUvD;;QACAa,KAAK,CAACb,YAAN,GAAqB1B,IAAI,CAACsC,IAAL,CAAU,KAAKZ,YAAf,EAA6B,IAA7B,CAArB;MACD;;MAEDN,QAAQ,CAACsB,IAAT,CAAcrB,OAAd,EAAuBkB,KAAvB,EAA8BC,QAA9B;;MAEA,IAAID,KAAJ,EAAW;QACT,KAAKP,IAAL,CAAU,cAAV,EAA0B;UACxBhB,GAAG,EAAE,KAAKR,OAAL,CAAaQ,GAAb,GAAmBE,IADA;UAExBC,MAAM,EAAEA,MAFgB;UAGxBwB,OAAO,EAAEJ,KAAK,CAACI,OAHS;UAIxBF,IAAI,EAAEF,KAAK,CAACE,IAJY;UAKxBV,MAAM,EAAEA;QALgB,CAA1B,EAMG,IANH;MAOD,CARD,MAQO;QACL,KAAKC,IAAL,CAAU,gBAAV,EAA4B;UAC1BhB,GAAG,EAAE,KAAKR,OAAL,CAAaQ,GAAb,GAAmBE,IADE;UAE1BC,MAAM,EAAEA,MAFkB;UAG1BqB,QAAQ,EAAEA,QAHgB;UAI1BT,MAAM,EAAEA;QAJkB,CAA5B,EAKG,IALH;MAMD;;MAED,KAAKC,IAAL,CAAU,YAAV,EAAwB;QACtBhB,GAAG,EAAE,KAAKR,OAAL,CAAaQ,GAAb,GAAmBE,IADF;QAEtBC,MAAM,EAAEA,MAFc;QAGtBY,MAAM,EAAEA;MAHc,CAAxB,EAIG,IAJH;IAKD,CAvCM,EAuCJ,IAvCI,CAAP;EAwCD,CApHiC;EAsHlCH,SAAS,EAAE,YAAY;IACrB,KAAK,IAAIgB,CAAC,GAAG,KAAK/B,aAAL,CAAmBgC,MAAnB,GAA4B,CAAzC,EAA4CD,CAAC,IAAI,CAAjD,EAAoDA,CAAC,EAArD,EAAyD;MACvD,IAAIpB,OAAO,GAAG,KAAKX,aAAL,CAAmB+B,CAAnB,CAAd;MACA,IAAIb,MAAM,GAAGP,OAAO,CAACsB,KAAR,EAAb;MACA,KAAKf,MAAL,EAAagB,KAAb,CAAmB,IAAnB,EAAyBvB,OAAzB;IACD;;IACD,KAAKX,aAAL,GAAqB,EAArB;EACD;AA7HiC,CAAf,CAAd;AAgIP,OAAO,SAASmC,OAAT,CAAkBxC,OAAlB,EAA2B;EAChCA,OAAO,GAAGJ,YAAY,CAACI,OAAD,CAAtB;EACA,OAAO,IAAIF,OAAJ,CAAYE,OAAZ,CAAP;AACD;AAED,eAAewC,OAAf"},"metadata":{},"sourceType":"module"}