{"ast":null,"code":"import { latLng } from 'leaflet';\nimport { Identify } from './Identify';\nimport { responseToFeatureCollection, boundsToExtent, _setGeometry } from '../Util';\nexport var IdentifyFeatures = Identify.extend({\n  setters: {\n    layers: 'layers',\n    precision: 'geometryPrecision',\n    tolerance: 'tolerance',\n    // skipped implementing this (for now) because the REST service implementation isnt consistent between operations.\n    // 'transform': 'datumTransformations'\n    returnGeometry: 'returnGeometry'\n  },\n  params: {\n    sr: 4326,\n    layers: 'all',\n    tolerance: 3,\n    returnGeometry: true\n  },\n  on: function (map) {\n    var extent = boundsToExtent(map.getBounds());\n    var size = map.getSize();\n    this.params.imageDisplay = [size.x, size.y, 96];\n    this.params.mapExtent = [extent.xmin, extent.ymin, extent.xmax, extent.ymax];\n    return this;\n  },\n  at: function (geometry) {\n    // cast lat, long pairs in raw array form manually\n    if (geometry.length === 2) {\n      geometry = latLng(geometry);\n    }\n\n    this._setGeometryParams(geometry);\n\n    return this;\n  },\n  layerDef: function (id, where) {\n    this.params.layerDefs = this.params.layerDefs ? this.params.layerDefs + ';' : '';\n    this.params.layerDefs += [id, where].join(':');\n    return this;\n  },\n  simplify: function (map, factor) {\n    var mapWidth = Math.abs(map.getBounds().getWest() - map.getBounds().getEast());\n    this.params.maxAllowableOffset = mapWidth / map.getSize().y * factor;\n    return this;\n  },\n  run: function (callback, context) {\n    return this.request(function (error, response) {\n      // immediately invoke with an error\n      if (error) {\n        callback.call(context, error, undefined, response); // ok no error lets just assume we have features...\n      } else {\n        var featureCollection = responseToFeatureCollection(response);\n        response.results = response.results.reverse();\n\n        for (var i = 0; i < featureCollection.features.length; i++) {\n          var feature = featureCollection.features[i];\n          feature.layerId = response.results[i].layerId;\n        }\n\n        callback.call(context, undefined, featureCollection, response);\n      }\n    });\n  },\n  _setGeometryParams: function (geometry) {\n    var converted = _setGeometry(geometry);\n\n    this.params.geometry = converted.geometry;\n    this.params.geometryType = converted.geometryType;\n  }\n});\nexport function identifyFeatures(options) {\n  return new IdentifyFeatures(options);\n}\nexport default identifyFeatures;","map":{"version":3,"names":["latLng","Identify","responseToFeatureCollection","boundsToExtent","_setGeometry","IdentifyFeatures","extend","setters","layers","precision","tolerance","returnGeometry","params","sr","on","map","extent","getBounds","size","getSize","imageDisplay","x","y","mapExtent","xmin","ymin","xmax","ymax","at","geometry","length","_setGeometryParams","layerDef","id","where","layerDefs","join","simplify","factor","mapWidth","Math","abs","getWest","getEast","maxAllowableOffset","run","callback","context","request","error","response","call","undefined","featureCollection","results","reverse","i","features","feature","layerId","converted","geometryType","identifyFeatures","options"],"sources":["C:/Users/Larix/Documents/Programmieren/ABSCHLUSS/wbs-final-box-fe/node_modules/esri-leaflet/src/Tasks/IdentifyFeatures.js"],"sourcesContent":["import { latLng } from 'leaflet';\r\nimport { Identify } from './Identify';\r\nimport { responseToFeatureCollection,\r\n  boundsToExtent,\r\n  _setGeometry\r\n} from '../Util';\r\n\r\nexport var IdentifyFeatures = Identify.extend({\r\n  setters: {\r\n    layers: 'layers',\r\n    precision: 'geometryPrecision',\r\n    tolerance: 'tolerance',\r\n    // skipped implementing this (for now) because the REST service implementation isnt consistent between operations.\r\n    // 'transform': 'datumTransformations'\r\n    returnGeometry: 'returnGeometry'\r\n  },\r\n\r\n  params: {\r\n    sr: 4326,\r\n    layers: 'all',\r\n    tolerance: 3,\r\n    returnGeometry: true\r\n  },\r\n\r\n  on: function (map) {\r\n    var extent = boundsToExtent(map.getBounds());\r\n    var size = map.getSize();\r\n    this.params.imageDisplay = [size.x, size.y, 96];\r\n    this.params.mapExtent = [extent.xmin, extent.ymin, extent.xmax, extent.ymax];\r\n    return this;\r\n  },\r\n\r\n  at: function (geometry) {\r\n    // cast lat, long pairs in raw array form manually\r\n    if (geometry.length === 2) {\r\n      geometry = latLng(geometry);\r\n    }\r\n    this._setGeometryParams(geometry);\r\n    return this;\r\n  },\r\n\r\n  layerDef: function (id, where) {\r\n    this.params.layerDefs = (this.params.layerDefs) ? this.params.layerDefs + ';' : '';\r\n    this.params.layerDefs += ([id, where]).join(':');\r\n    return this;\r\n  },\r\n\r\n  simplify: function (map, factor) {\r\n    var mapWidth = Math.abs(map.getBounds().getWest() - map.getBounds().getEast());\r\n    this.params.maxAllowableOffset = (mapWidth / map.getSize().y) * factor;\r\n    return this;\r\n  },\r\n\r\n  run: function (callback, context) {\r\n    return this.request(function (error, response) {\r\n      // immediately invoke with an error\r\n      if (error) {\r\n        callback.call(context, error, undefined, response);\r\n\r\n      // ok no error lets just assume we have features...\r\n      } else {\r\n        var featureCollection = responseToFeatureCollection(response);\r\n        response.results = response.results.reverse();\r\n        for (var i = 0; i < featureCollection.features.length; i++) {\r\n          var feature = featureCollection.features[i];\r\n          feature.layerId = response.results[i].layerId;\r\n        }\r\n        callback.call(context, undefined, featureCollection, response);\r\n      }\r\n    });\r\n  },\r\n\r\n  _setGeometryParams: function (geometry) {\r\n    var converted = _setGeometry(geometry);\r\n    this.params.geometry = converted.geometry;\r\n    this.params.geometryType = converted.geometryType;\r\n  }\r\n});\r\n\r\nexport function identifyFeatures (options) {\r\n  return new IdentifyFeatures(options);\r\n}\r\n\r\nexport default identifyFeatures;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}